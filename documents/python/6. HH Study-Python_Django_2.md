# 20190604 - HH Study - 장고 추가 설명



## Namespace 설정

1. #### 현상

   하나의 프로젝트에 두 개의 이상의 app 을 생성 후 실행하면 어떻게 될까? (단, 각 app 의 templates에 동일한 index.html 이 존재한다고 가정하자.)

   

   ```python
   INSTALLED_APPS = [
       # local apps
       'books.apps.BooksConfig',
       'pages.apps.PagesConfig',
   ]
   ```

   접속 url 에 상관없이 index.html 을 요청하면 Books app에 있는 index.html 이 실행된다. 

2. ### 원인

   templates 를 실행하는 장고의 특성 때문이다. 장고는 애플리케이션이 다르더라도 모든 templates 에 있는 파일은 하나로 합쳐서 실행한다. 그렇다면 동일한 파일 이름일 경우에는 순서가 필요할 것이다. 그 순서는 위의 Installed_apps 에 등록된 순서이다. 

3. ### 해결방법

   각 app 의 templates 안에 app 이름으로 폴더를 만드는 것이다. 그럼 장고는 templates 를 한꺼번에 인식하여도 그 아래 폴더의 이름이 다르기에 다르게 인식할 수 있다. 

   **(단, 이를 수정하면 views.py 에서 render(index.html) 을 render(폴더명/index.html) 로 바꿔줘야 한다.)**

   **static 파일도 동일하다.**



## Base Template 메인 프로젝트 폴더로 옮기기

#### 1. 기존

기존에는 각 애플리케이션의 Template 마다 base.html 을 두고 이를 상속하여 사용하였다. 하지만 base.html 을 모든 애플리케이션에서도 공통 모듈로 사용하고 싶으면 어떻게 할까?

#### 2. 변경

메인 프로젝트에 templates 를 만들고 base.html 을 만들면 된다. 단, 환경 설정을 변경해주어야 하는 것이 있다. 

```python
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [os.path.join(BASE_DIR, 'intro', 'templates')],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```

**위의 Dirs 는 원래 비어있어 메인 프로젝트의 templates 를 읽지 못하게 되어 있다. 이 곳을 위와 같이 수정해주어 읽을 수 있도록 해주어야 한다. 그리고 밑의 APP_DIRS 를 True 로 설정하여 app_name / templates 를 인식 가능하게 바꾸어 줘야 한다.**



## Reference

- https://www.getpostman.com/downloads/> : Get/Post 방식으로 데이터 통신간의 데이터를 확인을 편리하게 확인할 수 있게 도와준다.



## Full Managing

1. models.py 작성
2. makemigrations : 설계도 작성
3. migrate : DB 생성



DB - ORM

DB에 넣기 위한 모델을 만든다. SQL 문을 우리가 직접 건들지 않는다.

```
# id = models.AutoField(primary_key=True)
```

는 테이블 생성시 자동으로 생성된다.



CharField : String 의 길이 제한

TextField : 따로 길이 제한이 없음

시간 설정 : user_tz 는 model 에서도 사용자가 지정한 time_zone 을 적용시키기 위해 False로 설정한다.



테이블 생성 후 장고에 알려주어야 한다. 그럼 initial.py 가 생성된다.

` python manage.py makemigrations `

model 을 수정할 때마다 코드를 실행한다?



` python manage.py sqlmigrate boards 0002 ` 

SQL 문으로 번역된 것을 확인할 수 있다.



`python manage.py migrate` SQL에 넣기!

첫 마이그레이션은 무조건 위와 같이 한다. 



sqllite 다운로드

;C:\sqlite 계정의 환경변수에서 설정

그리고 git.bash 에서 아래 코드 실행

` winpty sqlite3`

.exit

이후 파이참 껐다가 다시 실행한다. 이후 sqlite3 하면 똑같이 실행되어야 한다.



sqlite3 db.sqlite3

.tables

.schema boards_board
